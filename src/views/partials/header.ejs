<header>
  <nav>
    <div class="logo">
  <img src="/images/logo nassamat bladi copie.png" alt="Nassamat Beladi" />
    </div>

    <button id="menu-toggle" class="menu-toggle" aria-label="فتح/إغلاق القائمة">
      <span></span><span></span><span></span>
    </button>

    <div class="nav-links" id="nav-links">
      <a href="/" class="nav-link">الرئيسية</a>
      <a href="/#products" class="nav-link">المتجر</a>
      <a href="/cart" class="nav-link cart-link">
        <i class="fas fa-shopping-cart"></i>
        السلة 
        <span class="cart-badge" id="cart-count">0</span>
      </a>
      <a href="/contact" class="nav-link">اتصل بنا</a>
      <% if (user) { %>
        <a href="/users/profile" class="nav-link">
          <i class="fas fa-user"></i> حسابي
        </a>
        <a href="/auth/logout" class="nav-link">تسجيل الخروج</a>
      <% } else { %>
        <a href="/auth/login" class="nav-link">تسجيل الدخول</a>
        <a href="/auth/signup" class="nav-link">إنشاء حساب</a>
      <% } %>
    </div>
  </nav>
</header>

<script>
(function(){
  const btn = document.getElementById('menu-toggle');
  const menu = document.getElementById('nav-links');
  if (!btn || !menu) return;
  
  btn.addEventListener('click', (e) => {
    e.stopPropagation();
    const isOpen = menu.classList.toggle('show');
    btn.classList.toggle('active', isOpen);
  });
  
  document.addEventListener('click', (e) => {
    if (!menu.contains(e.target) && !btn.contains(e.target)) {
      menu.classList.remove('show');
      btn.classList.remove('active');
    }
  });
  
  // Update cart count on page load
  function updateCartCount() {
    const cart = JSON.parse(localStorage.getItem('cart') || '[]');
    const total = cart.reduce((sum, item) => sum + item.quantity, 0);
    const el = document.getElementById('cart-count');
    if (el) el.textContent = total;
  }
  
  updateCartCount();
  
  // Listen for cart updates
  window.addEventListener('storage', updateCartCount);
})();
</script>
